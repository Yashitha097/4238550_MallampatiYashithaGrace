#include <stdio.h>
 
int h1[100000];
int s1 =0;
void exc(int *x,int *y){
    int store = *x;
    *x = *y;
    *y = store;
}
void exc_1(int idex_1){
    while(idex_1 >0){
        int p1 = (idex_1 -1)/2;
        if (h1[p1] > h1[idex_1]){
            exc(&h1[p1],&h1[idex_1]);
            idex_1 = p1;
        }
        else{
            break;
        }
    }
}
void exc_2(int idex_2){
    for(int k=1;k>0;k++){
        int l1 = 2* idex_2 +1;
        int r1 = 2* idex_2+2;
        int small_num = idex_2;
        if (l1 <s1 && h1[l1]<h1[small_num]){
            small_num = l1;
        }
        if (r1 <s1 && h1[r1] < h1[small_num]){
            small_num = r1;
        }
        if (small_num != idex_2){
            exc(&h1[small_num],&h1[idex_2]);
            idex_2 = small_num;
        }
        else{
            break;
        }
    }
}
void exc_3(int v1){
    h1[s1] = v1;
    s1++;
    exc_1(s1 - 1);
}
void exc_4(int v2){
    int i;
    for(i=0;i<s1;i++){
        if(h1[i]==v2){
            break;
        }
    }
    h1[i] = h1[s1 - 1];
    s1--;
   exc_1(i);
    exc_2(i);
    
}
int min_1(){
    return h1[0];
}
int main(){
    int o;
    scanf("%d",&o);
    while(o--){
        int style,z;
        scanf("%d",&style);
        if (style ==1){
            scanf("%d",&z);
            exc_3(z);
        }
        else if (style == 2){
            scanf("%d",&z);
            exc_4(z);
        }
        else if (style == 3){
            printf("%d\n",min_1());
        }
    }
    return 0;
}